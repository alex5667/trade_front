#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–æ—Ä—Ç–∞
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./scripts/kill-port.sh 3003

PORT=${1:-3003}

echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Ä—Ç $PORT..."

if lsof -i :$PORT > /dev/null 2>&1; then
    echo "‚ö†Ô∏è  –ü–æ—Ä—Ç $PORT –∑–∞–Ω—è—Ç, –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º..."
    fuser -k $PORT/tcp 2>/dev/null
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
    sleep 1
    if lsof -i :$PORT > /dev/null 2>&1; then
        echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –ø–æ—Ä—Ç $PORT"
        echo "üí° –ü–æ–ø—Ä–æ–±—É–π—Ç–µ: sudo fuser -k $PORT/tcp"
        exit 1
    else
        echo "‚úÖ –ü–æ—Ä—Ç $PORT —É—Å–ø–µ—à–Ω–æ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω!"
    fi
else
    echo "‚úÖ –ü–æ—Ä—Ç $PORT —É–∂–µ —Å–≤–æ–±–æ–¥–µ–Ω"
fi

exit 0

