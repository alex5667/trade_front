# üîå –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è Trade Front ‚Üî Trade Back

## üìã –û–±–∑–æ—Ä –ø–æ—Ä—Ç–æ–≤

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ—Ä—Ç—ã:

- **–ü–æ—Ä—Ç 3003** - Trade Front (Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
- **–ü–æ—Ä—Ç 4200** - Trade Back REST API (NestJS)
- **–ü–æ—Ä—Ç 4202** - Trade Back WebSocket Socket.IO —Å–µ—Ä–≤–µ—Ä

## üîó –°—Ö–µ–º–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

```
Trade Front (3003) ‚Üê‚Üí Trade Back WebSocket (4202) ‚Üê‚Üí Trade Back REST API (4200)
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Trade Front (Next.js)

Trade Front –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ WebSocket –Ω–∞ –ø–æ—Ä—Ç—É 4202 —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ `src/config/websocket.config.ts`:

```typescript
const DEFAULT_URLS = {
	development: 'http://localhost:4202', // WebSocket –ø–æ—Ä—Ç
	test: 'http://localhost:4202',
	production: 'https://your-production-websocket-url.com'
}
```

### Trade Back (NestJS)

Trade Back –∑–∞–ø—É—Å–∫–∞–µ—Ç:

- REST API –Ω–∞ –ø–æ—Ä—Ç—É 4200 (–æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
- WebSocket —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 4202 (–æ—Ç–¥–µ–ª—å–Ω—ã–π worker thread)

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

### 1. –ó–∞–ø—É—Å–∫ Trade Back

```bash
cd trade_back
export SOCKETIO_PORT=4202
export SOCKETIO_HOST=0.0.0.0
export PORT=4200
npm run start:dev
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
cd trade_back
./start-websocket.sh
```

### 2. –ó–∞–ø—É—Å–∫ Trade Front

```bash
cd trade_front
npm run dev
```

Trade Front –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 3003 –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ WebSocket –Ω–∞ –ø–æ—Ä—Ç—É 4202.

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å REST API
curl http://localhost:4200/api/health

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å WebSocket (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–∫—Ç–∏–≤–µ–Ω)
lsof -i :4202

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Trade Front
curl http://localhost:3003
```

### –õ–æ–≥–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–û—Ç–∫—Ä–æ–π—Ç–µ DevTools –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –∫–æ–Ω—Å–æ–ª—å - —Ç–∞–º –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ WebSocket:

```
üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Socket.IO: {url: "http://localhost:4202", ...}
üü¢ Socket.IO client connected: [client-id]
```

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "Connection refused"

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Trade Back –∑–∞–ø—É—â–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ WebSocket —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 4202
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –û—à–∏–±–∫–∞ "Port already in use"

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É 4202
lsof -ti:4202 | xargs kill -9

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Trade Back
npm run start:dev
```

### WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Trade Back –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ WebSocket
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 4202 –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω —Ñ–∞–π—Ä–≤–æ–ª–æ–º

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket

```typescript
import { TradeSignalSocketIOClient } from '@/services/socket-io.service'

const socketClient = new TradeSignalSocketIOClient()
socketClient.connect()
```

### –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è

```typescript
socketClient.on('signal:volatility', data => {
	console.log('–ü–æ–ª—É—á–µ–Ω —Å–∏–≥–Ω–∞–ª –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏:', data)
})
```

## üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ WebSocket –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Trade Back (Ctrl+C)
2. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Trade Front (Ctrl+C)
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å Trade Back —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å Trade Front

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ø—Ä–∏ –æ–±—Ä—ã–≤–µ —Å–≤—è–∑–∏
- –í—Å–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ WebSocket –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- REST API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –æ–ø–µ—Ä–∞—Ü–∏–π CRUD
- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –º–µ–∂–¥—É –ø–æ—Ä—Ç–∞–º–∏ 3003 –∏ 4202
