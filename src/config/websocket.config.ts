/**
 * –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Socket.IO
 * ------------------------------
 * –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Socket.IO —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
 * 
 * –≠—Ç–æ—Ç –º–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ Socket.IO —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
 * –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –ø—Ä–æ–¥–∞–∫—à–Ω, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ).
 * –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–∏–±–∫—É—é —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é
 * –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.
 */

/** URL-–∞–¥—Ä–µ—Å–∞ Socket.IO –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π */
const DEFAULT_URLS = {
	/** URL –¥–ª—è –æ–∫—Ä—É–∂–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ */
	development: 'http://localhost:4200',
	/** URL –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –æ–∫—Ä—É–∂–µ–Ω–∏—è */
	production: 'https://your-production-websocket-url.com',
	/** URL –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è */
	test: 'http://localhost:4201'
} as const

/**
 * –ü–æ–ª—É—á–∏—Ç—å URL Socket.IO –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
 * 
 * –§—É–Ω–∫—Ü–∏—è —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è NEXT_PUBLIC_SOCKET_URL,
 * –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç URL –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ
 * –æ–∫—Ä—É–∂–µ–Ω–∏—è (NODE_ENV). –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç ws:// –≤ http:// 
 * –∏ wss:// –≤ https:// –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å Socket.IO.
 * 
 * @returns URL Socket.IO —Å–µ—Ä–≤–µ—Ä–∞
 */
export const getWebSocketUrl = (): string => {
	// –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å URL –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
	let envUrl = process.env.NEXT_PUBLIC_SOCKET_URL
	if (envUrl) {
		// –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º WebSocket URL –≤ HTTP URL –¥–ª—è Socket.IO
		envUrl = envUrl.replace('ws://', 'http://').replace('wss://', 'https://')
		return envUrl
	}

	// –ò—Å–ø–æ–ª—å–∑—É–µ–º URL –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ NODE_ENV
	const env = process.env.NODE_ENV as keyof typeof DEFAULT_URLS
	return DEFAULT_URLS[env] || DEFAULT_URLS.development
}

/**
 * –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Socket.IO —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
 * 
 * –û–±—ä–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
 * Socket.IO —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è URL, —Ç–∞–π–º–∞—É—Ç—ã –∏ –ª–∏–º–∏—Ç—ã
 * –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.
 */
export const WEBSOCKET_CONFIG = {
	/** URL Socket.IO —Å–µ—Ä–≤–µ—Ä–∞ */
	url: getWebSocketUrl(),
	/** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è */
	maxReconnectAttempts: 15,
	/** –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–º—Å) */
	reconnectDelay: 5000,
	/** –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ ping —Å–æ–æ–±—â–µ–Ω–∏–π (–º—Å) */
	pingInterval: 30000, // 30 —Å–µ–∫—É–Ω–¥
	/** –¢–∞–π–º–∞—É—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–º—Å) */
	connectionTimeout: 10000, // 10 —Å–µ–∫—É–Ω–¥
} as const

/**
 * –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Socket.IO
 * 
 * –í—ã–≤–æ–¥–∏—Ç –≤ –∫–æ–Ω—Å–æ–ª—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Socket.IO —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
 * –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞. –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
 * –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º.
 */
export const logWebSocketConfig = () => {
	console.log('üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Socket.IO:', {
		url: WEBSOCKET_CONFIG.url,
		environment: process.env.NODE_ENV || 'development',
		maxReconnectAttempts: WEBSOCKET_CONFIG.maxReconnectAttempts,
		reconnectDelay: WEBSOCKET_CONFIG.reconnectDelay,
		pingInterval: WEBSOCKET_CONFIG.pingInterval
	})
} 